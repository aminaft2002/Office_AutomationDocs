
### ✅ اطلاعات پایه

|ویژگی|مقدار|
|---|---|
|🎯 نام یوزکیس|GetLettersSharedWithUser|
|🧩 دامنه مرتبط|Letter / LetterPermission|
|🎯 هدف|نمایش لیستی از نامه‌هایی که با کاربر فعلی به‌صورت مستقیم یا از طریق مجوز به اشتراک گذاشته شده‌اند|
|📦 نقش استفاده‌کننده|کاربر نهایی (کارمند یا مدیر)|
|🔐 مجوز مورد نیاز|مشاهده مجاز بر اساس `LetterPermission`|

---

### 📝 توضیح کلی

این یوزکیس به کاربر امکان می‌دهد فقط نامه‌هایی را ببیند که به‌صورت صریح یا ضمنی برای او قابل مشاهده هستند. این قابلیت به‌ویژه در سناریوهایی که نامه برای چند نفر ارجاع شده یا مجوز اختصاصی داده شده، کاربرد دارد.

---

### ✅ ورودی‌ها

|ورودی|نوع|توضیح|
|---|---|---|
|`UserId`|`Guid`|شناسه کاربری که می‌خواهد نامه‌های به‌اشتراک‌گذاشته‌شده را ببیند|
|`IncludeArchived`|`bool`|آیا نامه‌های آرشیوشده هم نمایش داده شوند؟|
|`TagFilter` _(اختیاری)_|`Guid`|فیلتر بر اساس یک تگ خاص|
|`StatusFilter` _(اختیاری)_|`LetterStatus`|فیلتر بر اساس وضعیت|
|`DateRange` _(اختیاری)_|`(DateTime From, DateTime To)`|فیلتر بازه زمانی ثبت نامه|
|`Paging`|`int page, int size`|صفحه‌بندی نتایج|

---

### 🎯 خروجی

|خروجی|نوع|توضیح|
|---|---|---|
|`List<LetterSummaryDto>`|لیست خلاصه‌ای از نامه‌ها|شامل عنوان، شماره نامه، وضعیت، تاریخ ثبت، تگ‌ها، ارسال‌کننده و گیرنده|
|`TotalCount`|`int`|تعداد کل نامه‌ها در نتیجه جستجو|

---

### 🧠 شرط‌ها و قوانین

- نامه‌هایی که `LetterPermission` برای `UserId` دارند یا گیرنده مستقیم هستند باید نمایش داده شوند.
    
- اگر نامه `IsConfidential = true` باشد، فقط در صورت داشتن مجوز خاص نمایش داده شود.
    
- کاربر نباید نامه‌هایی را که به‌صورت صریح برای او غیرفعال شده‌اند ببیند.
    
- اگر هیچ نامه‌ای با مجوز وجود نداشته باشد، خروجی لیست خالی است.
    

---

### 🔗 ارتباط با سایر یوزکیس‌ها

- ✅ مکمل با: `AssignLetterPermission`, `RevokeLetterPermission`
    
- ✅ قابل ترکیب با: `FilterLettersByTag`, `FilterLettersByStatus`
    
- ✅ خروجی قابل استفاده در: داشبورد، پنل ورودی کاربر، اعلان‌ها