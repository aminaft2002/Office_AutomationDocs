
### ๐ฏ ูุฏู:

ุงูฺฉุงู ุงุฑุณุงู (ุงุฑุฌุงุน) ฺฉ ูุงูู ููุฌูุฏ ุจู ฺฉุงุฑุจุฑ ุง ูุงุญุฏ ุฏฺฏุฑุ ุจุง ุงูฺฉุงู ุงูุฒูุฏู ุชูุถุญ ุงุฑุฌุงุนุ ุชุนู ุณุทุญ ุฏุณุชุฑุณุ ู ุชุนู ูุณุฑ ุจุนุฏ ฺฏุฑุฏุด ูุงูู (Routing).

---

### ๐งฉ ูพุดโูุงุฒูุง:

|ุดุฑุท|ุชูุถุญ|
|---|---|
|ูุงูู ุจุงุฏ ููุฌูุฏ ุจุงุดุฏ|ุจุฑุฑุณ `LetterId`|
|ฺฉุงุฑุจุฑ ุงุฑุณุงูโฺฉููุฏู ุจุงุฏ ุฏุณุชุฑุณ ุงุฑุณุงู ุง ุงุฑุฌุงุน ุฏุงุดุชู ุจุงุดุฏ|ุจุฑุฑุณ ุงุฒ `LetterPermission`|
|ฺฏุฑูุฏู ูุจุงุฏ ูุจูุงู ุฏุฑ ูุณุช ฺฏุฑูุฏฺฏุงู ูุงูู ุจุงุดุฏ (ูฺฏุฑ ุฏุฑ ุงุฑุฌุงุน ูุฌุฏุฏ ุจุง ูุณุฑ ูุชูุงูุช)|ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุงุฑุณุงู ุชฺฉุฑุงุฑ ุจู ฺฉ ูุณุฑ|
|ูุถุนุช ูุงูู ุจุงุฏ ูุงุจู ุงุฑุณุงู ุจุงุดุฏ|ูุซูุงู ูุจุงุฏ ุฏุฑ ุญุงูุช ุจุณุชู ุง ุจุงฺฏุงูโุดุฏู ุจุงุดุฏ ูฺฏุฑ ุงุณุชุซูุงุก ุชุนุฑู ุดุฏู|

---

### ๐ฅ ูุฑูุฏโูุง (Input)

|ููุฏ|ููุน|ุงูุฒุงูุ|ุชูุถุญ|
|---|---|---|---|
|`LetterId`|`Guid`|โ|ุดูุงุณู ูุงููโุง ฺฉู ุจุงุฏ ุงุฑุณุงู ุดูุฏ|
|`FromUserId`|`Guid`|โ|ฺฉุงุฑุจุฑ ุงุฑุณุงูโฺฉููุฏู|
|`ToUserId` ุง `ToUnitId`|`Guid`|โ|ฺฏุฑูุฏู ูุณุชูู ูุงูู|
|`RoutingNote`|`string?`|โ|ุชูุถุญ ุงุถุงูู ุงุฑุฌุงุน|
|`PermissionType`|`LetterPermissionType`|โ|ููุน ูุฌูุฒ ฺฉู ุจู ฺฏุฑูุฏู ุฏุงุฏู ูโุดูุฏ|
|`Deadline`|`DateTime?`|โ|ูููุช ุงูุฌุงู ุจุฑุง ฺฏุฑูุฏู|
|`ForwardType`|`enum`|โ|ููุน ุงุฑุฌุงุน: ูุณุชููุ ุฌูุช ุงูุฏุงูุ ุฌูุช ุงุทูุงุน|
|`IsFinal`|`bool`|โ|ุขุง ุงู ุงุฑุฌุงุน ูพุงุงู ูุณุฑ ูุงูู ุงุณุชุ (ุจุฑุง ุชุดุฎุต ูพุงุงู ูุฑุขูุฏ)|

---

### โ๏ธ ูุฑุงุญู ุงุฌุฑุง

1. ุจุฑุฑุณ ูุฌูุฏ ูุงูู ุจุง `LetterId`
    
2. ุจุฑุฑุณ ุงูฺฉู `FromUserId` ุฏุงุฑุง ุฏุณุชุฑุณ ฺฉุงู ุจุฑุง ุงุฑุณุงู ุงุณุช
    
3. ุจุฑุฑุณ ุตุญุช `ToUserId` ุง `ToUnitId`
    
4. ุจุฑุฑุณ ุนุฏู ูุฌูุฏ ุงุฑุฌุงุน ูุดุงุจู
    
5. ุงุฌุงุฏ ุฑฺฉูุฑุฏ ุฌุฏุฏ ุฏุฑ `LetterRouting`
    
6. ุงุฌุงุฏ ุฑฺฉูุฑุฏ ุฌุฏุฏ ุฏุฑ `LetterPermission` ุจุฑุง ฺฏุฑูุฏู
    
7. ุจูโุฑูุฒุฑุณุงู `Letter.hasReplies = true`
    
8. ุซุจุช ูุงฺฏ ุฏุฑ `LetterLog` ุจุง ููุน `Forwarded`
    

---

### ๐ค ุฎุฑูุฌ (Output)

|ููุฏ|ููุน|ุชูุถุญ|
|---|---|---|
|`Success`|`bool`|ููููุช ุนููุงุช|
|`Errors`|`List<string>`|ูุณุช ุฎุทุงูุง ุฏุฑ ุตูุฑุช ูุฌูุฏ|
|`RoutingId`|`Guid`|ุดูุงุณู ูุณุฑ ุงุฑุฌุงุน ุฌุฏุฏ|
|`GrantedPermissionId`|`Guid`|ุดูุงุณู ุณุทุญ ุฏุณุชุฑุณ ุฏุงุฏู ุดุฏู ุจู ฺฏุฑูุฏู|

---

### ๐ก๏ธ ฺฉูุชุฑูโูุง ุงููุช

- ุงุฑุณุงูโฺฉููุฏู ุจุงุฏ ุฏุณุชุฑุณ ุงุฑุฌุงุน (`CanForward`) ุง ุฏุณุชุฑุณ ูุฏุฑุช ุฏุงุดุชู ุจุงุดุฏ.
    
- ุณุณุชู ุงุฒ ุงุฑุฌุงุน ุจู ุฎูุฏ ุง ุงุฑุฌุงุน ุญูููโุง ุฌููฺฏุฑ ูโฺฉูุฏ.
    
- ูุญุฑูุงูฺฏ ูุงูู ุฏุฑ ุงุฑุฌุงุน ุจุฑุฑุณ ูโุดูุฏ (ููุท ุงูุฑุงุฏ ูุฌุงุฒ ูโุชูุงููุฏ ุจุจููุฏ).
    

---

### ๐ ุงุฑุชุจุงุท ุจุง ูุฏูโูุง

- `Letter`
    
- `User` / `Unit`
    
- `LetterRouting`
    
- `LetterPermission`
    
- `LetterLog`