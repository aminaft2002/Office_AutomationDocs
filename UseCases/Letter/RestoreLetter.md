### 🎯 هدف:

بازیابی یک نامه که قبلاً به صورت Soft Delete حذف شده، به وضعیت فعال قبلی آن در اینباکس یا پوشه مربوط بازگردد.

---

### 🧩 پیش‌نیازها:

|شرط|توضیح|
|---|---|
|نامه باید به صورت Soft Deleted باشد|بررسی `IsDeleted = true`|
|کاربر باید صاحب یا مجاز به دسترسی باشد|معمولاً کسی که آن را حذف کرده یا گیرنده اصلی است|

---

### 📥 ورودی‌ها (Input)

|فیلد|نوع|الزامی؟|توضیح|
|---|---|---|---|
|`LetterId`|`Guid`|✅|شناسه نامه‌ای که باید بازگردانی شود|
|`UserId`|`Guid`|✅|کاربر فعلی (برای اعتبارسنجی)|

---

### ⚙️ مراحل اجرایی

1. بررسی وجود نامه با `LetterId`
    
2. بررسی اینکه `IsDeleted == true` باشد
    
3. بررسی اینکه کاربر اجازه بازگردانی دارد (مثلاً حذف‌کننده اصلی است یا Admin)
    
4. تغییر فیلد `IsDeleted` به `false`
    
5. به‌روزرسانی `UpdatedAt`
    
6. بازگرداندن پیام موفقیت یا خطا
    

---

### 📤 خروجی (Output)

|فیلد|نوع|توضیح|
|---|---|---|
|`Success`|`bool`|آیا عملیات موفق بود؟|
|`Message`|`string`|پیام موفقیت یا خطا|
|`Errors`|`List<string>`|لیست خطاها در صورت وجود|

---

### 🧱 مدل مرتبط (Letter)

|فیلد|وضعیت|
|---|---|
|`IsDeleted`|باید از `true` به `false` تغییر کند|
|`UpdatedAt`|باید تاریخ فعلی ثبت شود|

---

### 🔒 امنیت و سطح دسترسی

|سناریو|سطح دسترسی مورد نیاز|
|---|---|
|بازگرداندن نامه|کاربر حذف‌کننده، Admin یا کاربر دارای دسترسی Restore|

---

### 💡 نکات تکمیلی:

- در صورت عدم وجود نامه یا عدم دسترسی، باید خطای مناسب برگردد.
    
- عملیات باید لاگ شود در `LetterLog` به‌صورت:
    
    - Action: `Restore`
        
    - Actor: `UserId`
        
    - Timestamp
        
    - IP یا متادیتای دیگر (در صورت نیاز)
