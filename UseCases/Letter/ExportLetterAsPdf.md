
### ุฎุฑูุฌ ฺฏุฑูุชู ุงุฒ ฺฉ ูุงูู ุจูโุตูุฑุช ูุงู PDF

---

### ๐ฏ ูุฏู:

ฺฉุงุฑุจุฑ ุจุชูุงูุฏ ฺฉ ูุงูู ุฑุง ุจุง ูุญุชูุง ฺฉุงููุ ูุฑุงุฏุงุฏู (ูุชุงุฏุชุง) ู ูพูุณุชโูุง (ุฏุฑ ุตูุฑุช ูุงุฒ) ุจูโุตูุฑุช ูุงู PDF ุฎุฑูุฌ ุจฺฏุฑุฏ.

---

### โ ุณูุงุฑููุง ฺฉุงุฑุจุฑุฏ

|ุณูุงุฑู|ุชูุถุญ|
|---|---|
|ุชูู ูุณุฎู PDF ุจุฑุง ฺุงูพ ูุฒฺฉ|ุจุง ูุฑูุช ุฑุณู ู ููฺฏู|
|ุงุฑุณุงู ูุงู PDF ูุงูู ุจู ุณุงุฒูุงู ุจุฑูู|ุจุฑุง ูุงููโูุง ุตุงุฏุฑู|
|ุฐุฎุฑูโุณุงุฒ ูุณุฎู ุขุฑุดู ุงุฒ ูุงูู|ุจูโููุฑุงู ุงูุถุง ุง ุดูุงุฑู ูุงูู ุฑุณู|

---

### ๐ฅ ูุฑูุฏโูุง (Input)

|ููุฏ|ููุน|ุงูุฒุงูุ|ุชูุถุญ|
|---|---|---|---|
|`LetterId`|`Guid`|โ|ุดูุงุณู ูุงูู ููุฑุฏูุธุฑ|
|`IncludeAttachments`|`bool`|โ|ุขุง ูพูุณุชโูุง ูุฒ ุฏุฑ PDF ุฏุฑุฌ ุดููุฏุ (ุงูุฒูุฏู ููฺฉ ุง ุงูุตุงู)|
|`ExportMode`|`enum`|โ|ุญุงูุช ุฎุฑูุฌ: ุฑุณูุ ูพุดโููุณุ ููุท ูุญุชูุงุ ููุฑุงู ููฺฏู|
|`RequestedByUserId`|`Guid`|โ|ุจุฑุง ูุงฺฏ ู ุจุฑุฑุณ ุณุทุญ ุฏุณุชุฑุณ|

csharp

CopyEdit

`enum ExportMode {   OfficialWithLogo,   DraftWithoutLogo,   ContentOnly }`

---

### โ๏ธ ูุฑุงุญู ุงุฌุฑุง

1. ุงุนุชุจุงุฑุณูุฌ `LetterId` ู ุจุฑุฑุณ ุณุทุญ ุฏุณุชุฑุณ ฺฉุงุฑุจุฑ
    
2. ุฏุฑุงูุช ุฏุงุฏูโูุง ฺฉุงูู ูุงูู ุงุฒ ุฏุชุงุจุณ:
    
    - ูุญุชูุง
        
    - ุงุทูุงุนุงุช ูุฑุณุชูุฏู/ฺฏุฑูุฏู
        
    - ุชุงุฑุฎ ู ุดูุงุฑู ุฑุณู
        
    - ูพูุณุชโูุง (ุฏุฑ ุตูุฑุช ูุงุฒ)
        
3. ุณุงุฎุช ูุงู PDF:
    
    - ุงุณุชูุงุฏู ุงุฒ ุชููพูุช ุฑุณู PDF
        
    - ุงุถุงููโฺฉุฑุฏู ูุงุชุฑูุงุฑฺฉุ ููฺฏู ุง ุณุฑุจุฑฺฏ (ุจุฑ ุงุณุงุณ ExportMode)
        
    - ุฏุฑุฌ ุงุทูุงุนุงุช ูุชุงุฏุชุง
        
4. ุจุงุฒฺฏุฑุฏุงูุฏู ููฺฉ ุงูู ุง ูุงู ุฎุฑูุฌ PDF
    

---

### ๐ค ุฎุฑูุฌ (Output)

|ููุฏ|ููุน|ุชูุถุญ|
|---|---|---|
|`FileName`|`string`|ูุงู ูุงู ุชููุฏ ุดุฏู|
|`DownloadUrl`|`string`|ููฺฉ ูููุช ุจุฑุง ุฏุฑุงูุช PDF|
|`GeneratedAt`|`DateTime`|ุฒูุงู ุชููุฏ ุฎุฑูุฌ|

---

### ๐ ูฺฉุงุช ููู

- ูพุงุฏูโุณุงุฒ PDF ูโุชูุงูุฏ ุงุฒ ุงุจุฒุงุฑูุง ูุงููุฏ `iTextSharp`ุ `QuestPDF` ุง `DinkToPdf` ุงุณุชูุงุฏู ฺฉูุฏ.
    
- ูุงูุจ PDF ุจุงุฏ ูุงุจูุช ุณูุงุฑุดโุณุงุฒ ุฏุงุดุชู ุจุงุดุฏ (ูููุช ูุงุฑุณุ ูุงูุจ ูุงูู ุฑุณูุ ุชุงุฑุฎ ุดูุณ)
    
- ุงฺฏุฑ ูุงูู ููุง ูุดุฏู ุจุงุดุฏ (`IsFinalized == false`)ุ ุฏุฑ PDF ุจุฑฺุณุจ ูพุดโููุณ ุฏุฑุฌ ุดูุฏ.
    
- ุณุทุญ ุฏุณุชุฑุณ ุจุฑุฑุณ ุดูุฏ (ุจุฑุง ูุงููโูุง ูุญุฑูุงูู ุง ุฏุงุฎู)