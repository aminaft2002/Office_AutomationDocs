
### 📄 Use Case: GetLetterAttachments

|ویژگی|مقدار|
|---|---|
|**نام یوزکیس**|GetLetterAttachments|
|**هدف**|بازیابی و نمایش لیست کامل فایل‌های پیوست‌شده به یک نامه خاص|
|**Actor**|کاربر مجاز به مشاهده نامه|
|**Trigger**|کاربر روی دکمه «پیوست‌ها» یا آیکون 📎 در صفحه جزئیات نامه کلیک می‌کند|

---

### 🧩 Preconditions (پیش‌نیازها):

- نامه در سیستم وجود داشته باشد.
    
- کاربر مجاز به مشاهده محتوای آن نامه باشد.
    

---

### ⚙️ Main Flow (روند اصلی):

1. کاربر درخواست دریافت پیوست‌های مربوط به یک `LetterId` مشخص را ارسال می‌کند.
    
2. سیستم ابتدا وجود نامه را بررسی می‌کند.
    
3. سپس از طریق رابطه `Letter → LetterAttachment` تمامی پیوست‌های مرتبط با نامه را واکشی می‌کند.
    
4. برای هر پیوست، اطلاعات فایل (نام، نوع، اندازه، تاریخ آپلود، آپلودکننده) نمایش داده می‌شود.
    

---

### 🔄 Alternative Flow (روند جایگزین):

|شماره|شرط|روند جایگزین|
|---|---|---|
|A1|نامه یافت نشد|خطای `404 - Letter Not Found` نمایش داده می‌شود|
|A2|کاربر به نامه دسترسی ندارد|خطای `403 - Access Denied` نمایش داده می‌شود|
|A3|هیچ پیوستی برای نامه وجود ندارد|پیغام "بدون پیوست" نمایش داده می‌شود|

---

### 📦 Output (خروجی):
[
  {
    "attachmentId": "guid",
    "fileName": "string",
    "fileType": "string",
    "fileSize": 2405120,
    "uploadedAt": "datetime",
    "uploadedBy": {
      "userId": "guid",
      "fullName": "string"
    },
    "downloadUrl": "string"
  },
  ...
]
### 📚 وابستگی‌ها:

- Entity: `LetterAttachment`
    
- Relation: `Letter 1:N LetterAttachment`
    
- امنیت فایل‌ها از طریق توکن‌های موقت (Signed URL) قابل مدیریت است.