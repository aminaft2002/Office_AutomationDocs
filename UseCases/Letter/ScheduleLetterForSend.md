### 🕒 Use Case: `ScheduleLetterForSend` (زمان‌بندی ارسال نامه)

|ویژگی|توضیح|
|---|---|
|**هدف**|امکان زمان‌بندی ارسال خودکار نامه در تاریخ و ساعت مشخص در آینده|
|**Actor**|`AuthenticatedUser` (کاربر دارای مجوز ارسال نامه)|
|**Trigger**|کاربر هنگام ایجاد یا ویرایش نامه، گزینه «ارسال در زمان مشخص» را فعال می‌کند|
|**Preconditions**|- نامه در وضعیت `Draft` یا `InProgress` باشد  <br>- زمان انتخاب‌شده در آینده باشد  <br>- نامه تمام اعتبارسنجی‌های لازم را پاس کند|
|**Postconditions**|- یک رکورد زمان‌بندی برای ارسال در زمان مشخص ثبت می‌شود  <br>- سیستم در زمان تعیین‌شده نامه را ارسال خواهد کرد|
|**سناریو اصلی**|1. کاربر نامه‌ای را ایجاد یا ویرایش می‌کند  <br>2. گزینه «ارسال زمان‌بندی‌شده» را انتخاب می‌کند  <br>3. کاربر تاریخ و زمان ارسال را تعیین می‌کند  <br>4. سیستم صحت زمان را بررسی می‌کند  <br>5. سیستم وضعیت نامه را به `Scheduled` تغییر می‌دهد و یک رکورد در جدول `ScheduledTasks` ثبت می‌کند  <br>6. در زمان مقرر، سیستم فرآیند `SendLetter` را اجرا می‌کند|
|**Alternative Flows**|- اگر زمان گذشته باشد، خطای "زمان نامعتبر" نمایش داده می‌شود  <br>- اگر نامه وضعیت `Finalized` داشته باشد، اجازه زمان‌بندی داده نمی‌شود|
|**Validation Rules**|- تاریخ و ساعت باید در آینده باشد  <br>- نامه باید فیلدهای الزامی برای ارسال را داشته باشد (گیرنده، عنوان، متن و...)|
|**Business Rules**|- زمان‌بندی قابل ویرایش یا لغو است تا قبل از موعد اجرا  <br>- هر کاربر فقط می‌تواند نامه‌های خودش را زمان‌بندی کند|
|**جداول دخیل**|`Letter`, `ScheduledTask` یا `LetterSchedule` (در صورت نیاز به جدول جداگانه)|
|**وضعیت نامه**|`LetterStatus.Scheduled` تا زمان اجرای ارسال|
|**Status**|✅ Completed|