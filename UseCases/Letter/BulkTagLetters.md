
### ✅ اطلاعات پایه

|ویژگی|مقدار|
|---|---|
|🎯 نام یوزکیس|BulkTagLetters|
|🧩 دامنه مرتبط|Letter, LetterTag|
|🎯 هدف|اضافه‌کردن یک یا چند تگ به گروهی از نامه‌ها به‌صورت یکجا|
|👤 استفاده‌کننده|کاربران دارای سطح دسترسی مناسب (مثلاً کارمند، مدیر)|
|🔐 پیش‌نیاز دسترسی|دسترسی به نامه‌ها و امکان تگ‌گذاری آن‌ها|

---

### 📝 توضیح کلی

این یوزکیس به کاربر اجازه می‌دهد تا یک یا چند **تگ مشخص** را به گروهی از نامه‌ها **به‌صورت هم‌زمان** اختصاص دهد. این کار در مدیریت و فیلتر سریع‌تر نامه‌ها بسیار مؤثر است.

---

### ✅ ورودی‌ها

|ورودی|نوع|توضیح|
|---|---|---|
|`UserId`|`Guid`|شناسه کاربر|
|`LetterIds`|`List<Guid>`|لیست شناسه نامه‌ها|
|`TagIds`|`List<Guid>`|لیست شناسه تگ‌هایی که باید به هر نامه اضافه شوند|

---

### 🎯 خروجی

|خروجی|نوع|توضیح|
|---|---|---|
|`TaggedCount`|`int`|تعداد موفقیت‌آمیز عملیات تگ‌گذاری|
|`FailedIds`|`List<Guid>`|نامه‌هایی که به دلایلی (مثلاً عدم دسترسی یا تکراری بودن تگ) تگ‌گذاری نشدند|

---

### 🧠 قوانین و شرط‌ها

- نامه باید برای کاربر قابل‌مشاهده باشد.
    
- اگر تگی از قبل روی نامه باشد، دوباره اضافه نمی‌شود (بررسی تکراری بودن).
    
- بعد از اعمال، لاگ اقدام برای هر نامه ثبت می‌شود (`LogLetterAction`).
    
- در صورت نبود تگ، خطا برمی‌گردد (ولیدیشن اولیه روی `TagIds`).
    

---

### 🔗 ارتباط با سایر یوزکیس‌ها

- وابسته به: `AssignLetterTag`, `CheckUserPermission`
    
- مکمل: `RemoveLetterTag`, `FilterLettersByTag`, `GroupLetterByTag`