
### 🧾 Use Case: `LockUserAccount`

**(قفل کردن حساب یک کاربر توسط مدیر برای جلوگیری از ورود به سیستم)**

|ویژگی|توضیح|
|---|---|
|**هدف (Goal)**|جلوگیری از دسترسی کاربر به سیستم با قفل کردن حساب|
|**نقش‌های مجاز (Actors)**||

- `Admin`
    
- `SecurityManager`
    
- `UserManager` |  
    | **پیش‌شرط‌ها (Preconditions)** |
    
- کاربر هدف باید وجود داشته باشد
    
- کاربر هدف قبلاً قفل نشده باشد
    
- مدیر باید دارای مجوز `LockUserPermission` باشد |  
    | **پس‌شرط‌ها (Postconditions)** |
    
- کاربر دیگر نمی‌تواند وارد سیستم شود تا زمانی که حساب باز شود |
    

---

### 🔁 جریان اصلی (Main Flow)

1. مدیر وارد پنل مدیریت کاربران می‌شود
    
2. کاربر هدف را از لیست کاربران انتخاب می‌کند
    
3. روی دکمه "قفل حساب" کلیک می‌کند
    
4. سیستم با تأیید مدیر، وضعیت حساب کاربر را به "Locked" تغییر می‌دهد
    
5. پیام موفقیت نمایش داده می‌شود
    

---

### 🔐 پیاده‌سازی فنی (Domain & Infrastructure)

|ویژگی|مقدار|
|---|---|
|فیلد در دیتابیس|`IsLocked` (bool) یا `LockedAt` (DateTime?)|
|رفتار امنیتی|بررسی `IsLocked` در هنگام لاگین، و جلوگیری از احراز هویت|
|لاگ امنیتی|ثبت عملیات قفل کردن توسط چه کسی و چه زمانی|

---

### 🔄 جریان جایگزین (Alternate Flows)

- اگر حساب کاربر از قبل قفل باشد → پیام "قبلاً قفل شده است"
    
- اگر کاربر مجاز به این عملیات نباشد → پیام خطای مجوز
    
- اگر حساب ادمین اصلی باشد → جلوگیری از قفل (Rule خاص)
    

---

### ❗ استثناها (Exceptions)

- اختلال در سرور یا دیتابیس
    
- تلاش برای قفل کردن حساب غیرمجاز (مثلاً خود ادمین)
    

---

### ✅ خروجی

- پیام موفقیت یا خطا (JSON یا UI Notification)
    
- به‌روزرسانی وضعیت حساب در پنل مدیریت